<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Film Ekle</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="form-container" id="form-container">
        <h2>Film Ekle</h2>
        <form id="login-form" onsubmit="return validateForm(event)">
            <input type="email" id="username" class="input-field" placeholder="Film Adı" required><br>
            <input type="password" id="password" class="input-field" placeholder="Favori Karakter" required><br>
            <button type="submit" class="submit-btn">Film Ekle</button>
            <a href="#" class="forgot-password">Favori Karakterinizi mi Unuttunuz?</a>
        </form>
    </div>

    <!-- AppSheet iframe -->
    <div id="appsheet-container" class="appsheet-container" style="display:none;">
        <iframe id="appsheet-iframe" 
                src="https://www.appsheet.com/start/4ae2c219-2ac4-461f-908d-9f29b3f3092e" 
                width="100%" 
                height="100%" 
                frameborder="0" 
                style="border:none;" 
                allowfullscreen
                sandbox="allow-forms allow-scripts allow-same-origin allow-popups">
        </iframe>
    </div>

    <!-- Firebase SDK for Web -->
    <script type="module">
        // Firebase modüllerini import et
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-analytics.js";

        // Firebase yapılandırma
        const firebaseConfig = {
            apiKey: "AIzaSyD9MbTqWGXLLYrp4x8nwu9mYx0y_t8dpJA",
            authDomain: "filmler-4a09c.firebaseapp.com",
            projectId: "filmler-4a09c",
            storageBucket: "filmler-4a09c.firebasestorage.app",
            messagingSenderId: "779802018978",
            appId: "1:779802018978:web:03563cf09a7316ae1503fb",
            measurementId: "G-47T9LZNDV4"
        };

        // Firebase'i başlat
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const analytics = getAnalytics(app);

        // Giriş fonksiyonu
        function loginUser(email, password) {
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Giriş başarılı, kullanıcı bilgileri
                    const user = userCredential.user;
                    console.log('Giriş başarılı:', user);
                    alert('Giriş başarılı!');
                    
                    // Formu gizle ve AppSheet iframe'ini göster
                    document.getElementById('form-container').style.display = "none";
                    document.getElementById('appsheet-container').style.display = "block";
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.log('Giriş hatası:', errorMessage);
                    alert('Kullanıcı adı veya şifre hatalı!');
                });
        }

        // Formu kontrol et
        function validateForm(event) {
            event.preventDefault();  // Sayfanın yeniden yüklenmesini engelle

            // Formdan verileri al
            const email = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Giriş işlemi yap
            loginUser(email, password);
        }
    </script>

    <script src="script.js"></script>
</body>
</html>
